<template>
	<view>
		<swiper class="swiper bg-f" :class="[myclass]" :indicator-dots="data.length > 1 ? true :false" :vertical="false" :autoplay="false" :duration="1"
		 :circular="false" :style="{height:rowNum<=1 ? (itemH+10)*2+'rpx':itemH*2+secH*(rowNum-1)*2+20+'rpx'}" v-if="isturnpage">
			<swiper-item v-for="(item,index) in sdata" :key="index" :style="{height:rowNum<=1 ? (itemH+10)*2+'rpx':itemH*2+secH*(rowNum-1)*2+20+'rpx'}">
				<view class="Nav_btn" :class="['item_'+num]" :style="{padding:`${tbPadding*2}rpx ${lrPadding*2}rpx`}">
					<view class="item" :style="{padding:`${itemPadding*2}rpx 0`,}" v-for="(v,index2) in item" :key="index2" @click="back(v)">
						<view class="Nav_img" :style="{height:!v['icon']?imgHeight*2+'rpx':''}">
							<view class="group" v-if="!v['icon']">
								<image class="img" :src="v[filedCover]" :style="{width:imgWidth*2+'rpx',height:imgHeight*2+'rpx',borderRadius:imgR*2+'rpx'}"/>
								<view class="num" v-if="v.number" :style="{backgroundColor:numBg,fontSize:numSize*2+'rpx',color:numColor,}">{{ v.number }}</view>
							</view>
							<view class="group" v-if="v.icon">
								<view class="icon" :class="[v.icon]" :style="{fontSize:iconSize*2+'rpx',color:v.iColor?v.iColor:iconColor }"></view>
								<view class="num" v-if="v.number" :style="{backgroundColor:numBg,fontSize:numSize*2+'rpx',color:numColor,borderColor:numBd}">{{ v.number }}</view>
							</view>
						</view>
						<view class="txt" :style="{fontSize:nameSize*2+'rpx',color:nameColor,lineHeight:lineHeight*2+'rpx',paddingTop:namePTop*2+'rpx'}">{{ v[filedName] }}</view>
						<slot :name="'tips'+index"></slot>
					</view>
					<slot></slot>
				</view>
			</swiper-item>
		</swiper>
		<view class="Nav_btn" :class="[myclass,'item_'+num]" :style="{padding:`${tbPadding*2}rpx ${lrPadding*2}rpx`}" v-else>
			
			<view class="item" :style="{padding:`${itemPadding*2}rpx 0`,}" v-for="(v,index) in data" :key="index" @click="back(v)">
				<button hover-class="none" class="contact-btn" open-type="contact" v-if="v.category=='contact'">
					<view class="Nav_img" :style="{height:!v['icon']?imgHeight*2+'rpx':''}">
						<view class="group" v-if="!v['icon']">
							<image class="img" :src="v[filedCover]" :style="{width:imgWidth*2+'rpx',height:imgHeight*2+'rpx',borderRadius:imgR*2+'rpx'}"/>
							<view class="num" v-if="v.number" :style="{backgroundColor:numBg,fontSize:numSize*2+'rpx',color:numColor,}">{{ v.number }}</view>
						</view>
						<view class="group" v-if="v.icon">
							<view class="icon" :class="[v.icon]" :style="{fontSize:iconSize*2+'rpx',color:v.iColor?v.iColor:iconColor }"></view>
							<view class="num" v-if="v.number" :style="{backgroundColor:numBg,fontSize:numSize*2+'rpx',color:numColor,borderColor:numBd}">{{ v.number }}</view>
						</view>
					</view>
					<view class="txt" :style="{fontSize:nameSize*2+'rpx',color:nameColor,lineHeight:lineHeight*2+'rpx',paddingTop:namePTop*2+'rpx'}">{{ v[filedName] }}</view>
					<slot :name="'tips'+index"></slot>
				</button>
				<view v-else>
					<view class="Nav_img" :style="{height:!v['icon']?imgHeight*2+'rpx':''}">
						<view class="group" v-if="!v['icon']">
							<image class="img" :src="v[filedCover]" :style="{width:imgWidth*2+'rpx',height:imgHeight*2+'rpx',borderRadius:imgR*2+'rpx'}"/>
							<view class="num" v-if="v.number" :style="{backgroundColor:numBg,fontSize:numSize*2+'rpx',color:numColor,}">{{ v.number }}</view>
						</view>
						<view class="group" v-if="v.icon">
							<view class="icon" :class="[v.icon]" :style="{fontSize:iconSize*2+'rpx',color:v.iColor?v.iColor:iconColor }"></view>
							<view class="num" v-if="v.number" :style="{backgroundColor:numBg,fontSize:numSize*2+'rpx',color:numColor,borderColor:numBd}">{{ v.number }}</view>
						</view>
					</view>
					<view class="txt" :style="{fontSize:nameSize*2+'rpx',color:nameColor,lineHeight:lineHeight*2+'rpx',paddingTop:namePTop*2+'rpx'}">{{ v[filedName] }}</view>
					<slot :name="'tips'+index"></slot>
				</view>
			</view>
			<slot></slot>
		</view>
	</view>
</template>

<script>
	export default{
		props: {
			// 数组
			data: {
				type: Array,
				default () {
					return []
				}
			},
			isturnpage:{
				type:Boolean,
				default: false,
			},
			// 自定义样式
			myclass:{
				type:String,
				default:''
			},
			// 整框左右距离
			lrPadding:{
				type:Number,
				default: 5
			},
			// 整框上下距离
			tbPadding:{
				type:Number,
				default: 5
			},
			// 一行显示多少个
			num:{
				type:Number,
				default: 5
			},
			//rpx 只对左右padding起作用，上下为0
			itemPadding: {
				type: Number,
				default: 10
			},
			// 图片宽度
			imgWidth: {
				type: Number,
				default: 50
			},
			// 图片高度
			imgHeight: {
				type:  Number,
				default: 50
			},
			// 图片弧度
			imgR: {
				type:  Number,
				default: 6
			},
			// 字体大小
			nameSize: {
				type: Number,
				default: 13
			},
			// 字体颜色
			nameColor: {
				type: String,
				default: '#333'
			},
			// 字体行高
			lineHeight:{
				type: Number,
				default: 20
			},
			// 字体与图片的距离
			namePTop:{
				type: Number,
				default: 8
			},
			pageNum:{
				type:Number,
				default:5
			},
			// 图标大小
			iconSize: {
				type: Number,
				default: 22
			},
			// 图标颜色
			iconColor: {
				type: String,
				default: '#333'
			},
			// 图标背景色
			iconBg:{
				type:String,
				default: ''
			},
			iconPadding:{
				type:String,
				default: ''
			},
			iconR:{
				type:String,
				default: ''
			},
			iconStyle:{
				type:String,
				default: ''
			},
			filedName: {
				type: String,
				default: "name"
			},
			filedCover: {
				type: String,
				default: "cover"
			},
			number:{
				type: String,
				default: ""
			},
			// 数字大小
			numSize: {
				type: Number,
				default: 10
			},
			// 数字颜色
			numColor: {
				type: String,
				default: 'red'
			},
			// 数字背景色
			numBg:{
				type: String,
				default: '#fff'
			},
			// 数字线条颜色
			numBd:{
				type: String,
				default: 'red'
			}
		},
		data(){
			return {
				itemH:0,
				rowNum:0,
				secH: 0,
				sdata:[]
			}
		},
		created(){
			this.navheight()
			let sdataKey = 0;
			let nextPageNum = this.pageNum;
			if(this.isturnpage == true){
				this.data.forEach((item,key) => {
					// 判断是否语法错误
					if(!this.sdata[sdataKey]){
						this.sdata[sdataKey]=[]
					}
					// 数组重组
					this.sdata[sdataKey].push(item);
					// 循环数组
					if(key >= nextPageNum-1){
						sdataKey++;
						nextPageNum=nextPageNum+this.pageNum;
						console.log('nextPageNum'+nextPageNum)
					}
					console.log(this.sdata)
				})
				this.navrow()
			}
		},
		// watch: {
		//     data: {
		//       handler(newValue, oldValue) {
		// 		this.data = newValue;
		// 		console.log(this.data);
		//       },
		//       deep: true
		//     }
		//   },
		methods:{
			navrow:function(){
				let rowNum = Math.ceil(this.sdata[0].length / this.num)
				this.rowNum = rowNum
				console.log(121121,rowNum,)
				
			},
			navheight: function(){
				let imgH = this.imgHeight
				let nameH = this.lineHeight + this.namePTop
				let itemH = imgH + nameH + this.itemPadding*2 +this.tbPadding*2
				let secH = imgH+nameH+this.itemPadding*2
				this.itemH = itemH
				this.secH = secH
				console.log(123123,itemH,secH)
			},
			back(v){
				console.log(v);
				this.$emit('click',v);
			}
		}
	}
</script>
<style scoped>
	
.Nav_btn{background: white;display: flex;flex-wrap: wrap;}
.Nav_btn .item{width: 20%;text-align: center;}
.Nav_btn .item .Nav_img {text-align: center;text-align: -webkit-center;}
.Nav_btn .item .Nav_img .img{display: flex;justify-content: center;}
.Nav_btn .item .Nav_img .icon{display: inline-block;line-height: 1.2;}
.Nav_btn .item .Nav_img .group{position: relative;display: inline-block;}
.Nav_btn .item .Nav_img .group .num{position: absolute;top: -16upx;right: -16upx;border-radius: 50%;width: 36upx;line-height: 32upx;text-align: center;border-width: 2upx;border-style: solid;}
.Nav_btn .item .txt{text-align: center;}
.Nav_btn.item_6 .item{width: 16.666%;}
.Nav_btn.item_4 .item{width: 25%;}
.Nav_btn.item_3 .item{width: 33.333%;}
.Nav_btn.item_2 .item{width: 50%;}

.contact-btn{border-radius: 0;background-color: transparent;padding: 0;text-align: left;border: none;font-size: inherit;line-height: inherit;}
.contact-btn::after{border: none;}
</style>